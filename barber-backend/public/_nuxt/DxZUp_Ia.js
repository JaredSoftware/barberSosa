var s={};const n=()=>typeof window<"u"?window.location.origin:s.NUXT_PUBLIC_API_BASE||"http://localhost",c={authHeaders(e){if(!e)return{};const t=`Bearer ${e}`;return{Authorization:t,"X-Forwarded-Authorization":t,"Content-Type":"application/json"}},async getCurrentUser(e){try{const t=n(),o=await fetch(`${t}/api/auth/me`,{credentials:"include",headers:this.authHeaders(e)});if(!o.ok)throw new Error("No autenticado");return await o.json()}catch(t){return console.error("Error obteniendo usuario:",t),null}},async login(e,t){try{const o=n(),r=await fetch(`${o}/api/auth/login`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok){const i=await r.json();throw new Error(i.message||"Error al iniciar sesiÃ³n")}const a=await r.json();return this.setToken(a.access_token),a}catch(o){throw console.error("Error en login:",o),o}},async register(e){try{const t=n(),o=await fetch(`${t}/api/auth/register`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){const a=await o.json();throw new Error(a.message||"Error al registrar usuario")}const r=await o.json();return this.setToken(r.access_token),r}catch(t){throw console.error("Error en registro:",t),t}},loginWithGoogle(){const e=n();window.location.href=`${e}/api/auth/google`},getToken(){return typeof window<"u"?localStorage.getItem("access_token"):null},setToken(e){typeof window<"u"&&localStorage.setItem("access_token",e)},async logout(){if(typeof window<"u"){try{await fetch(`${n()}/api/auth/logout`,{credentials:"include",method:"GET"})}catch{}localStorage.removeItem("access_token")}},removeToken(){typeof window<"u"&&localStorage.removeItem("access_token")},isAuthenticated(){return!!this.getToken()}};export{c as a};
