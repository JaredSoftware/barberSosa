import{_ as N}from"./DaIHgnVo.js";import{r as g,g as S,u as j,c as a,a as t,k as D,h as y,b as w,w as h,i as r,t as n,F as M,j as U,s as _,v as c,x as u,D as G,o as i,d as A,n as R}from"./DubxvCNo.js";import{u as L}from"./B7Hvwl0c.js";import{u as q}from"./B7jaE2zm.js";import"./DxZUp_Ia.js";import"./DD9xvv_g.js";import"./CFgllcZz.js";const z={class:"min-h-screen bg-background-deep py-8 px-4"},F={class:"max-w-7xl mx-auto"},I={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6"},T={key:0,class:"text-center py-12"},$={key:1,class:"text-center py-12 bg-charcoal border border-red-500/30 rounded-sm"},H={class:"text-gray-400 text-sm mb-4"},O={key:2,class:"text-center py-12 bg-charcoal border border-primary/20 rounded-sm"},P={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"},J={class:"flex items-start gap-4 mb-4"},K={class:"w-20 h-20 rounded-sm overflow-hidden border border-white/10 shrink-0 bg-black/40"},Q=["src","alt"],W={key:1,class:"w-full h-full flex items-center justify-center text-white/30"},X={class:"flex-1 min-w-0"},Y={class:"text-white font-bold text-lg uppercase tracking-wider truncate"},Z={key:0,class:"text-primary/90 text-xs font-bold uppercase tracking-wider mt-0.5"},ee={key:0,class:"text-gray-400 text-sm leading-relaxed line-clamp-3 mb-4 flex-1"},te={key:1,class:"text-gray-500 text-xs italic mb-4 flex-1"},se=["title"],re=["onClick"],oe={class:"bg-charcoal border border-primary/20 rounded-sm p-8 max-w-md w-full max-h-[90vh] overflow-y-auto"},ae={class:"flex items-center gap-2"},ie={key:0,class:"text-red-400 text-sm"},le={class:"flex gap-2 pt-4"},ne=["disabled"],fe={__name:"barbers",setup(de){const{isAuthenticated:V}=L(),{barbers:f,loading:p,error:v,fetchAdminBarbers:x,updateBarber:B}=q(),m=g(null),d=g(""),o=g({nombreArtista:"",rol:"",imagen:"",descripcion:"",activo:!0});S(async()=>{if(V.value)try{await x()}catch{}});function C(l){m.value=l,o.value={nombreArtista:l.nombreArtista||"",rol:l.rol||"",imagen:l.imagen||"",descripcion:l.descripcion||"",activo:l.activo!==!1},d.value=""}function b(){m.value=null,d.value=""}async function E(){d.value="";try{await B(m.value._id,{nombreArtista:o.value.nombreArtista.trim()||void 0,rol:o.value.rol.trim()||void 0,imagen:o.value.imagen.trim()||void 0,descripcion:o.value.descripcion.trim()||void 0,activo:o.value.activo}),b(),await x()}catch(l){d.value=l.message||"Error al guardar"}}return j({title:"Barberos - Admin"}),(l,e)=>{const k=N;return i(),a("div",z,[t("div",F,[t("div",I,[t("div",null,[w(k,{to:"/admin",class:"text-gray-400 hover:text-primary text-sm mb-2 inline-block transition-colors"},{default:h(()=>e[6]||(e[6]=[A(" ← Volver al Dashboard ")])),_:1,__:[6]}),e[7]||(e[7]=t("h1",{class:"text-white text-3xl sm:text-4xl font-display font-bold uppercase tracking-widest"}," Barberos ",-1)),e[8]||(e[8]=t("p",{class:"text-gray-500 text-sm mt-1"},"Imagen, nombre artístico y descripción que se muestran en Reservas",-1))])]),e[23]||(e[23]=D('<div class="bg-charcoal/80 border border-primary/20 rounded-sm p-4 sm:p-5 mb-8 text-sm"><p class="text-gray-300 mb-2"> Los barberos se crean al <strong class="text-primary">conectar una cuenta de Google</strong> desde el dashboard. Aquí puedes editar la <strong class="text-white">ficha pública</strong>: nombre artístico, rol, imagen y descripción que aparecen en la página de reservas. </p><p class="text-gray-500 text-xs mt-2">Si un barbero está inactivo, no se mostrará en la selección de reservas.</p></div>',1)),r(p)?(i(),a("div",T,e[9]||(e[9]=[t("p",{class:"text-gray-400"},"Cargando barberos...",-1)]))):r(v)?(i(),a("div",$,[e[10]||(e[10]=t("p",{class:"text-red-400 mb-2"},"Error al cargar la lista.",-1)),t("p",H,n(r(v)),1),e[11]||(e[11]=t("p",{class:"text-gray-500 text-xs"},"Si has cerrado sesión, vuelve a entrar en el admin e intenta de nuevo.",-1)),t("button",{type:"button",onClick:e[0]||(e[0]=s=>r(x)().catch(()=>{})),class:"mt-4 text-primary hover:underline text-sm"},"Reintentar")])):r(f).length===0?(i(),a("div",O,[e[13]||(e[13]=t("p",{class:"text-gray-400 mb-2"},"No hay barberos registrados.",-1)),e[14]||(e[14]=t("p",{class:"text-gray-500 text-sm"},"Conecta una cuenta de Google desde el Panel de Administración para añadir barberos.",-1)),w(k,{to:"/admin",class:"inline-block mt-4 text-primary hover:underline text-sm"},{default:h(()=>e[12]||(e[12]=[A("Ir al Dashboard →")])),_:1,__:[12]})])):(i(),a("div",P,[(i(!0),a(M,null,U(r(f),s=>(i(),a("div",{key:s._id,class:"bg-charcoal border border-primary/20 rounded-sm p-6 hover:border-primary/40 transition-all flex flex-col"},[t("div",J,[t("div",K,[s.imagen||s.picture?(i(),a("img",{key:0,src:s.imagen||s.picture,alt:s.nombreArtista||s.name,class:"w-full h-full object-cover"},null,8,Q)):(i(),a("div",W,e[15]||(e[15]=[t("span",{class:"material-symbols-outlined text-4xl"},"person",-1)])))]),t("div",X,[t("h3",Y,n(s.nombreArtista||s.name||s.email),1),s.rol?(i(),a("p",Z,n(s.rol),1)):y("",!0),t("span",{class:R([s.activo!==!1?"bg-green-600":"bg-gray-600","inline-block mt-2 text-xs px-2 py-1 rounded text-white"])},n(s.activo!==!1?"Visible en reservas":"Oculto"),3)])]),s.descripcion?(i(),a("p",ee,n(s.descripcion),1)):(i(),a("p",te,"Sin descripción")),t("p",{class:"text-gray-500 text-xs mb-4 truncate",title:s.email},n(s.email),9,se),t("button",{type:"button",onClick:ce=>C(s),class:"w-full bg-primary/20 hover:bg-primary/30 text-primary font-bold py-2 px-4 rounded-sm transition-all text-sm uppercase tracking-wider"}," Editar ficha ",8,re)]))),128))])),r(m)?(i(),a("div",{key:4,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:_(b,["self"])},[t("div",oe,[e[22]||(e[22]=t("h2",{class:"text-white text-2xl font-display font-bold uppercase tracking-widest mb-6"}," Editar barbero ",-1)),t("form",{onSubmit:_(E,["prevent"]),class:"space-y-4"},[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Nombre artístico",-1)),c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r(o).nombreArtista=s),type:"text",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary",placeholder:"Ej. Ricardo Sosa"},null,512),[[u,r(o).nombreArtista]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Rol / título",-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r(o).rol=s),type:"text",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary",placeholder:"Ej. Fundador & Master"},null,512),[[u,r(o).rol]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"URL de imagen",-1)),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(o).imagen=s),type:"url",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary",placeholder:"https://..."},null,512),[[u,r(o).imagen]]),e[19]||(e[19]=t("p",{class:"text-gray-500 text-xs mt-1"},"Si está vacío se usará la foto de Google.",-1))]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Descripción",-1)),c(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(o).descripcion=s),rows:"3",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary resize-none",placeholder:"Breve descripción del barbero..."},null,512),[[u,r(o).descripcion]])]),t("div",ae,[c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>r(o).activo=s),type:"checkbox",id:"activo",class:"rounded border-primary/30 text-primary focus:ring-primary"},null,512),[[G,r(o).activo]]),e[21]||(e[21]=t("label",{for:"activo",class:"text-gray-300 text-sm"},"Visible en la página de reservas",-1))]),r(d)?(i(),a("div",ie,n(r(d)),1)):y("",!0),t("div",le,[t("button",{type:"button",onClick:b,class:"flex-1 bg-white/10 hover:bg-white/20 text-white font-bold py-2 px-4 rounded-sm transition-all"}," Cancelar "),t("button",{type:"submit",disabled:r(p),class:"flex-1 bg-gold-gradient text-background-deep font-black uppercase tracking-wider py-2 px-4 rounded-sm hover:brightness-110 disabled:opacity-50"},n(r(p)?"Guardando...":"Guardar"),9,ne)])],32)])])):y("",!0)])])}}};export{fe as default};
