import{a as f}from"./DxZUp_Ia.js";import{u as l}from"./DD9xvv_g.js";var p={};const c=()=>typeof window<"u"?window.location.origin:p.NUXT_PUBLIC_API_BASE||"http://10.90.61.11",u={async getActivos(){const r=await fetch(`${c()}/api/barberos`,{headers:{"Content-Type":"application/json"},cache:"no-store"});if(!r.ok)throw new Error("Error al obtener barberos");return r.json()},async getAdminList(r){const a=r?`Bearer ${r}`:"",e=await fetch(`${c()}/api/barberos/admin/list`,{credentials:"include",headers:{"Content-Type":"application/json",Authorization:a,"X-Forwarded-Authorization":a},cache:"no-store"});if(!e.ok)throw new Error("Error al obtener barberos");return e.json()},async getOne(r,a){const e=a?`Bearer ${a}`:"",n=await fetch(`${c()}/api/barberos/admin/${r}`,{credentials:"include",headers:{"Content-Type":"application/json",Authorization:e,"X-Forwarded-Authorization":e}});if(!n.ok)throw new Error("Error al obtener el barbero");return n.json()},async update(r,a,e){const n=e?`Bearer ${e}`:"",i=await fetch(`${c()}/api/barberos/${r}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:n,"X-Forwarded-Authorization":n},body:JSON.stringify(a)});if(!i.ok){const b=await i.json().catch(()=>({}));throw new Error(b.message||"Error al actualizar el barbero")}return i.json()}},A=()=>{const r=l("barbers",()=>[]),a=l("barbers_loading",()=>!1),e=l("barbers_error",()=>null);return{barbers:r,loading:a,error:e,fetchBarbers:async(o=!1)=>{a.value=!0,e.value=null;try{o&&(r.value=[]);const t=await u.getActivos();return r.value=t,r.value}catch(t){return e.value=t.message||"Error al obtener barberos",[]}finally{a.value=!1}},fetchAdminBarbers:async()=>{const o=f.getToken();if(!o)throw new Error("No autenticado");a.value=!0,e.value=null;try{const t=await u.getAdminList(o);return r.value=Array.isArray(t)?t:[],r.value}catch(t){throw e.value=t.message||"Error al obtener barberos",r.value=[],t}finally{a.value=!1}},updateBarber:async(o,t)=>{const d=f.getToken();if(!d)throw new Error("No autenticado");a.value=!0,e.value=null;try{const s=await u.update(o,t,d),h=r.value.findIndex(w=>w._id===o);return h!==-1&&(r.value[h]=s),s}catch(s){throw e.value=s.message||"Error al actualizar el barbero",s}finally{a.value=!1}}}};export{A as u};
