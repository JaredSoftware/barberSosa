import{r as p,m as T,e as E,p as U,c as a,o as l,a as e,h as w,i as o,F as N,j as A,n as B,t as m,q,g as z,d as P,b as F,s as M,v as I,x as $}from"./DubxvCNo.js";import{u as L}from"./Bx_0lK-4.js";import{_ as V}from"./DlAUqK2U.js";const H={class:"booking-calendar p-6 rounded-xl premium-border bg-opacity-10 bg-black backdrop-blur-sm"},W={class:"flex justify-between items-center mb-6"},G={class:"flex gap-2"},K=["disabled"],J={class:"grid grid-cols-7 gap-2 mb-8"},Q=["onClick"],Z={class:"text-xs uppercase opacity-80"},X={class:"text-lg"},Y={key:0,class:"animate-fade-in"},ee={key:0,class:"flex justify-center py-8"},te={key:1,class:"text-center py-8 text-gray-400"},oe={key:2,class:"grid grid-cols-3 sm:grid-cols-4 gap-3"},se=["onClick"],ne={__name:"BookingCalendar",props:{barberId:{type:String,required:!0}},emits:["slotSelected"],setup(R,{emit:j}){const v=R,y=j,x=p(null),i=p(null),u=p([]),f=p(!1),g=p(new Date),k=T().public.apiBase,S=E(()=>{const s=[],n=new Date(g.value);for(let c=0;c<7;c++){const _=new Date(n);_.setDate(n.getDate()+c),s.push({dateStr:_.toISOString().split("T")[0],dayName:_.toLocaleDateString("es-ES",{weekday:"short"}),dayNumber:_.getDate()})}return s}),C=E(()=>{const s=new Date,n=new Date(g.value);return n<=s&&n.toDateString()!==s.toDateString()});function d(){const s=new Date(g.value);s.setDate(s.getDate()-7),s<new Date?g.value=new Date:g.value=s}function t(){const s=new Date(g.value);s.setDate(s.getDate()+7),g.value=s}async function D(s){x.value=s,i.value=null,await h(s)}function r(s){i.value=s,y("slotSelected",s)}async function h(s){if(v.barberId){f.value=!0;try{const{data:n}=await L(`${k}/api/appointments/availability`,{params:{barberId:v.barberId,date:s}},"$rfMhV3ITK1");n.value&&(u.value=n.value)}catch(n){console.error("Error fetching slots:",n),u.value=[]}finally{f.value=!1}}}const O=E(()=>u.value.map(s=>{const n=new Date(s);return{iso:s,time:n.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}}));return U(()=>v.barberId,()=>{x.value=null,i.value=null,u.value=[]}),(s,n)=>(l(),a("div",H,[e("div",W,[n[2]||(n[2]=e("h3",{class:"text-xl font-bold text-gold-gradient font-cinzel"}," SELECCIONAR FECHA ",-1)),e("div",G,[e("button",{onClick:d,disabled:o(C),class:"p-2 text-gold-400 hover:text-white transition-colors disabled:opacity-50"},n[0]||(n[0]=[e("span",{class:"material-symbols-outlined"},"chevron_left",-1)]),8,K),e("button",{onClick:t,class:"p-2 text-gold-400 hover:text-white transition-colors"},n[1]||(n[1]=[e("span",{class:"material-symbols-outlined"},"chevron_right",-1)]))])]),e("div",J,[(l(!0),a(N,null,A(o(S),c=>(l(),a("div",{key:c.dateStr,onClick:_=>D(c.dateStr),class:B(["flex flex-col items-center p-3 rounded-lg cursor-pointer transition-all duration-300 border border-transparent hover:border-gold-500/30",o(x)===c.dateStr?"bg-gold-gradient text-black font-bold":"bg-white/5 text-gray-300"])},[e("span",Z,m(c.dayName),1),e("span",X,m(c.dayNumber),1)],10,Q))),128))]),o(x)?(l(),a("div",Y,[n[4]||(n[4]=e("h3",{class:"text-xl font-bold text-gold-gradient font-cinzel mb-4"}," HORARIOS DISPONIBLES ",-1)),o(f)?(l(),a("div",ee,n[3]||(n[3]=[e("div",{class:"animate-spin h-8 w-8 border-2 border-gold-500 rounded-full border-t-transparent"},null,-1)]))):o(u).length===0?(l(),a("div",te," No hay horarios disponibles para esta fecha. ")):(l(),a("div",oe,[(l(!0),a(N,null,A(o(O),c=>(l(),a("button",{key:c.iso,onClick:_=>r(c.iso),class:B(["py-2 px-4 rounded-md text-sm transition-all duration-300 border",o(i)===c.iso?"bg-gold-500 text-black border-gold-500 font-bold shadow-[0_0_15px_rgba(212,175,55,0.4)]":"bg-transparent text-gold-400 border-gold-500/30 hover:border-gold-500 hover:bg-gold-500/10"])},m(c.time),11,se))),128))]))])):w("",!0)]))}},ae=V(ne,[["__scopeId","data-v-3b1a4113"]]),le={class:"min-h-screen bg-[#0A0A0A] text-white pt-24 pb-12 px-4"},re={class:"max-w-4xl mx-auto"},ie={class:"grid md:grid-cols-2 gap-8"},de={class:"space-y-8"},ce={class:"space-y-4"},ue={key:0,class:"text-gold-400"},be={key:1,class:"grid grid-cols-2 gap-4"},ge=["onClick"],pe={class:"aspect-square bg-gray-800 relative"},me=["src","alt"],fe={key:1,class:"w-full h-full flex items-center justify-center text-gray-600"},xe={class:"absolute inset-0 bg-gradient-to-t from-black/90 to-transparent flex flex-col justify-end p-3"},ve={class:"font-bold text-white"},_e={class:"text-xs text-gold-400"},ye={key:0,class:"space-y-4 animate-fade-in-up"},he={key:0,class:"relative"},we={class:"sticky top-24"},ke={class:"p-6 rounded-xl border border-gold-500/30 bg-[#111] shadow-[0_0_30px_rgba(0,0,0,0.5)]"},Se={class:"space-y-4 mb-6 text-sm text-gray-300"},Ce={class:"flex justify-between border-b border-gray-800 pb-2"},De={class:"font-bold text-white"},Ee={class:"flex justify-between border-b border-gray-800 pb-2"},Ie={class:"font-bold text-white"},$e={class:"flex justify-between border-b border-gray-800 pb-2"},Ne={class:"font-bold text-white"},Ae={key:0,class:"p-3 bg-red-900/30 border border-red-800 rounded text-red-400 text-sm"},Be=["disabled"],Le={key:0},Re={key:1},je={__name:"booking",setup(R){const v=T().public.apiBase,y=p([]),x=p(!0),i=p(null),u=p(null),f=p(!1),g=p(""),b=q({clientName:"",clientEmail:"",clientPhone:""});z(async()=>{try{const{data:d}=await L(`${v}/api/barberos`,"$CL-OBPdQhZ");d.value&&(y.value=d.value)}catch(d){console.error("Error fetching barbers",d)}finally{x.value=!1}});function k(d){i.value=d,u.value=null}function S(d){u.value=d}async function C(){f.value=!0,g.value="";try{const{data:d,error:t}=await L(`${v}/api/appointments`,{method:"POST",body:{barberId:i.value._id,date:u.value,clientName:b.clientName,clientEmail:b.clientEmail,clientPhone:b.clientPhone}},"$63J2pIaUKg");if(t.value)throw new Error(t.value.message||"Error creating appointment");alert("Cita reservada con éxito!"),u.value=null,i.value=null,b.clientName="",b.clientEmail="",b.clientPhone=""}catch(d){g.value="No se pudo reservar la cita. El horario podría no estar disponible.",console.error(d)}finally{f.value=!1}}return(d,t)=>{const D=ae;return l(),a("div",le,[e("div",re,[t[13]||(t[13]=e("h1",{class:"text-4xl md:text-5xl font-bold text-center mb-4 font-cinzel text-gold-gradient"}," RESERVAR CITA ",-1)),t[14]||(t[14]=e("p",{class:"text-center text-gray-400 mb-12 max-w-2xl mx-auto"}," Selecciona tu barbero de preferencia y el horario que mejor se adapte a ti. ",-1)),e("div",ie,[e("div",de,[e("div",ce,[t[4]||(t[4]=e("h2",{class:"text-2xl font-cinzel text-white flex items-center gap-2"},[e("span",{class:"flex items-center justify-center w-8 h-8 rounded-full bg-gold-gradient text-black text-sm font-bold"},"1"),P(" ELIGE TU BARBERO ")],-1)),o(x)?(l(),a("div",ue," Cargando barberos... ")):(l(),a("div",be,[(l(!0),a(N,null,A(o(y),r=>{var h;return l(),a("div",{key:r._id,onClick:O=>k(r),class:B(["cursor-pointer group relative overflow-hidden rounded-lg border transition-all duration-300",((h=o(i))==null?void 0:h._id)===r._id?"border-gold-500 bg-white/5":"border-white/10 hover:border-gold-500/50"])},[e("div",pe,[r.picture||r.imagen?(l(),a("img",{key:0,src:r.imagen||r.picture,alt:r.name,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"},null,8,me)):(l(),a("div",fe,t[3]||(t[3]=[e("span",{class:"material-symbols-outlined text-4xl"},"person",-1)]))),e("div",xe,[e("p",ve,m(r.nombreArtista||r.name),1),e("p",_e,m(r.rol||"Barber"),1)])])],10,ge)}),128))]))]),o(i)?(l(),a("div",ye,[t[5]||(t[5]=e("h2",{class:"text-2xl font-cinzel text-white flex items-center gap-2"},[e("span",{class:"flex items-center justify-center w-8 h-8 rounded-full bg-gold-gradient text-black text-sm font-bold"},"2"),P(" SELECCIONA HORARIO ")],-1)),F(D,{barberId:o(i)._id,onSlotSelected:S},null,8,["barberId"])])):w("",!0)]),o(u)&&o(i)?(l(),a("div",he,[e("div",we,[e("div",ke,[t[12]||(t[12]=e("h2",{class:"text-2xl font-cinzel text-gold-gradient mb-6 text-center"}," CONFIGURACIÓN ",-1)),e("div",Se,[e("div",Ce,[t[6]||(t[6]=e("span",null,"Barbero:",-1)),e("span",De,m(o(i).nombreArtista||o(i).name),1)]),e("div",Ee,[t[7]||(t[7]=e("span",null,"Fecha:",-1)),e("span",Ie,m(new Date(o(u)).toLocaleDateString()),1)]),e("div",$e,[t[8]||(t[8]=e("span",null,"Hora:",-1)),e("span",Ne,m(new Date(o(u)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)])]),e("form",{onSubmit:M(C,["prevent"]),class:"space-y-4"},[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-xs uppercase tracking-wider text-gray-500 mb-1"},"Nombre Completo",-1)),I(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>o(b).clientName=r),type:"text",required:"",class:"w-full bg-black/50 border border-gray-700 rounded-md p-2 text-white focus:border-gold-500 focus:ring-0 transition-colors"},null,512),[[$,o(b).clientName]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-xs uppercase tracking-wider text-gray-500 mb-1"},"Email",-1)),I(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>o(b).clientEmail=r),type:"email",required:"",class:"w-full bg-black/50 border border-gray-700 rounded-md p-2 text-white focus:border-gold-500 focus:ring-0 transition-colors"},null,512),[[$,o(b).clientEmail]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-xs uppercase tracking-wider text-gray-500 mb-1"},"Teléfono",-1)),I(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>o(b).clientPhone=r),type:"tel",required:"",class:"w-full bg-black/50 border border-gray-700 rounded-md p-2 text-white focus:border-gold-500 focus:ring-0 transition-colors"},null,512),[[$,o(b).clientPhone]])]),o(g)?(l(),a("div",Ae,m(o(g)),1)):w("",!0),e("button",{type:"submit",disabled:o(f),class:"w-full py-3 mt-4 bg-gold-gradient text-black font-bold uppercase tracking-widest rounded transition-transform active:scale-95 disabled:opacity-70 hover:shadow-[0_0_20px_rgba(212,175,55,0.3)]"},[o(f)?(l(),a("span",Le,"Procesando...")):(l(),a("span",Re,"Confirmar Cita"))],8,Be)],32)])])])):w("",!0)])])])}}},Ve=V(je,[["__scopeId","data-v-eb8bfc2b"]]);export{Ve as default};
