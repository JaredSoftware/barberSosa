import{r as y,g as j,u as q,c as i,a as e,h as p,d as z,i as a,F as f,j as k,s as w,t as n,v as u,x as m,y as A,D as B,o as l,n as S}from"./DubxvCNo.js";import{u as $}from"./B7Hvwl0c.js";import{u as F}from"./DbmS-_H1.js";import{u as G}from"./Dk9IIhO2.js";import"./DxZUp_Ia.js";import"./DD9xvv_g.js";import"./CFgllcZz.js";const L={class:"dark min-h-screen"},T={class:"min-h-screen bg-background-deep py-8 px-4"},H={class:"max-w-7xl mx-auto"},I={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8"},R={key:0,class:"text-center py-12"},J={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8"},K={class:"absolute top-4 right-4"},O={class:"mb-4"},Q={key:0,class:"w-full h-32 bg-background-deep rounded-sm mb-3 overflow-hidden"},W=["src","alt"],X={class:"text-white text-xl font-display font-bold uppercase tracking-widest mb-2"},Y={class:"text-gray-500 text-xs uppercase mb-2"},Z={class:"text-gray-400 text-sm leading-relaxed mb-4 line-clamp-2"},ee={class:"flex items-baseline justify-between mb-4 pb-4 border-b border-primary/10"},te={class:"text-primary font-bold text-2xl"},re={key:0,class:"text-gray-500 text-xs uppercase"},oe={class:"flex gap-2 mt-4"},ae=["onClick"],se=["onClick"],ie={key:2,class:"text-center py-12 bg-charcoal border border-primary/20 rounded-sm"},le={class:"bg-charcoal border border-primary/20 rounded-sm p-8 max-w-md w-full max-h-[90vh] overflow-y-auto"},ne={class:"text-white text-2xl font-display font-bold uppercase tracking-widest mb-6"},de={key:0,disabled:"",value:""},ce=["value"],ue={key:0,class:"text-gray-500 text-xs mt-1"},pe={class:"flex items-center gap-2"},me={class:"flex gap-4 pt-4"},ge={type:"submit",class:"flex-1 bg-gold-gradient text-background-deep font-black uppercase tracking-[0.2em] py-3 px-6 rounded-sm hover:brightness-110 transition-all shadow-lg"},_e={__name:"products",setup(be){const{isAuthenticated:h}=$(),{products:v,loading:_,fetchProducts:b,createProduct:C,updateProduct:P,deleteProduct:E}=F(),{categories:d,fetchCategories:N}=G(),g=y(!1),c=y(null),o=y({name:"",category:"",description:"",price:0,image:"",badge:"",active:!0});j(async()=>{h.value&&(await Promise.all([b(!1),N(!0)]),d.value.length>0&&!o.value.category&&(o.value.category=d.value[0].name))});const V=s=>{c.value=s,o.value={name:s.name,category:s.category,description:s.description,price:s.price,image:s.image||"",badge:s.badge||"",active:s.active!==!1},g.value=!0},x=()=>{g.value=!1,c.value=null,o.value={name:"",category:d.value.length>0?d.value[0].name:"",description:"",price:0,image:"",badge:"",active:!0}},U=async()=>{try{const s={name:o.value.name.trim(),category:o.value.category,description:o.value.description.trim(),price:Number(o.value.price),active:o.value.active!==!1,image:(o.value.image??"").trim(),badge:(o.value.badge??"").trim()||void 0};c.value?await P(c.value._id,s):await C(s),x(),await b(!1)}catch(s){console.error("Error guardando producto:",s),alert("Error al guardar: "+(s.message||"Error desconocido"))}},D=async s=>{if(confirm("¿Eliminar este producto? Esta acción no se puede deshacer."))try{await E(s),await b(!1)}catch(t){console.error("Error eliminando producto:",t),alert("Error al eliminar: "+(t.message||"Error desconocido"))}};return q({title:"Gestionar Productos - Admin Panel"}),(s,t)=>(l(),i("div",L,[e("div",T,[e("div",H,[e("div",I,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-white text-3xl sm:text-4xl font-display font-bold uppercase tracking-widest"}," Gestionar Productos ")],-1)),e("button",{onClick:t[0]||(t[0]=r=>g.value=!0),class:"bg-gold-gradient text-background-deep font-black uppercase tracking-[0.2em] py-3 px-6 rounded-sm hover:brightness-110 transition-all shadow-lg flex items-center gap-2"},t[8]||(t[8]=[e("span",{class:"material-symbols-outlined"},"add",-1),z(" Nuevo Producto ")]))]),a(_)?(l(),i("div",R,t[10]||(t[10]=[e("p",{class:"text-gray-400"},"Cargando productos...",-1)]))):a(v).length>0?(l(),i("div",J,[(l(!0),i(f,null,k(a(v),r=>(l(),i("div",{key:r._id,class:"bg-charcoal border border-primary/20 rounded-sm p-6 hover:border-primary/40 transition-all group relative overflow-hidden"},[e("div",K,[e("span",{class:S([r.active?"bg-green-600":"bg-gray-600","text-xs px-2 py-1 rounded text-white"])},n(r.active?"Activo":"Inactivo"),3)]),e("div",O,[r.image?(l(),i("div",Q,[e("img",{src:r.image,alt:r.name,class:"w-full h-full object-cover"},null,8,W)])):p("",!0),e("h3",X,n(r.name),1),e("p",Y,n(r.category),1),e("p",Z,n(r.description),1)]),e("div",ee,[e("span",te,"$"+n(Number(r.price).toFixed(2)),1),r.badge?(l(),i("span",re,n(r.badge),1)):p("",!0)]),e("div",oe,[e("button",{onClick:M=>V(r),class:"flex-1 bg-primary/20 hover:bg-primary/30 text-primary font-bold py-2 px-4 rounded-sm transition-all text-sm uppercase tracking-wider"}," Editar ",8,ae),e("button",{onClick:M=>D(r._id),class:"flex-1 bg-red-600/20 hover:bg-red-600/30 text-red-400 font-bold py-2 px-4 rounded-sm transition-all text-sm uppercase tracking-wider"}," Eliminar ",8,se)])]))),128))])):(l(),i("div",ie,t[11]||(t[11]=[e("p",{class:"text-gray-400"},"No hay productos. Crea uno para que aparezca en el catálogo.",-1)]))),a(g)||a(c)?(l(),i("div",{key:3,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:w(x,["self"])},[e("div",le,[e("h2",ne,n(a(c)?"Editar Producto":"Nuevo Producto"),1),e("form",{onSubmit:w(U,["prevent"]),class:"space-y-4"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Nombre *",-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>a(o).name=r),type:"text",required:"",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary transition-colors",placeholder:"Ej: Bálsamo de Sándalo"},null,512),[[m,a(o).name]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Categoría *",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>a(o).category=r),required:"",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary transition-colors"},[a(d).length===0?(l(),i("option",de,"Cargando categorías...")):p("",!0),(l(!0),i(f,null,k(a(d),r=>(l(),i("option",{key:r._id,value:r.name},n(r.name),9,ce))),128))],512),[[A,a(o).category]]),a(d).length===0?(l(),i("p",ue," Debes crear categorías primero en el panel de admin. ")):p("",!0)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Descripción *",-1)),u(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=r=>a(o).description=r),required:"",rows:"3",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary transition-colors resize-none",placeholder:"Descripción del producto"},null,512),[[m,a(o).description]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Precio *",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>a(o).price=r),type:"number",step:"0.01",min:"0",required:"",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary transition-colors",placeholder:"0.00"},null,512),[[m,a(o).price,void 0,{number:!0}]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"URL de imagen",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>a(o).image=r),type:"url",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary transition-colors",placeholder:"https://..."},null,512),[[m,a(o).image]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-gray-400 text-sm font-medium mb-2 uppercase tracking-wider"},"Badge (opcional)",-1)),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>a(o).badge=r),type:"text",class:"w-full bg-background-deep border border-primary/20 text-white rounded-sm px-4 py-3 focus:outline-none focus:border-primary transition-colors",placeholder:"Premium, Nuevo, etc."},null,512),[[m,a(o).badge]])]),e("div",pe,[u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>a(o).active=r),type:"checkbox",id:"active",class:"rounded border-primary/20 bg-background-deep text-primary focus:ring-primary"},null,512),[[B,a(o).active]]),t[18]||(t[18]=e("label",{for:"active",class:"text-gray-400 text-sm uppercase tracking-wider"},"Producto visible en catálogo",-1))]),e("div",me,[e("button",ge,n(a(c)?"Actualizar":"Crear"),1),e("button",{type:"button",onClick:x,class:"flex-1 bg-background-deep border border-primary/20 text-gray-400 hover:text-white font-bold py-3 px-6 rounded-sm transition-all uppercase tracking-wider"}," Cancelar ")])],32)])])):p("",!0)])])]))}};export{_e as default};
